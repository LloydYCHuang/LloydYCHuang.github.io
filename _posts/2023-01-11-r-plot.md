---
layout: default
categories: R
title:  "從零開始使用R進行完整的科學繪圖 (持續更新)"
---  
## 從零開始使用R進行完整的科學繪圖 (持續更新)  
2023/01/11  
*最後更新：2023.01.12*  
在進行科學研究的時候，我們不可避免的需要繪製各種圖像來協助表達，這些需求包含但不限於口頭報告、海報、研討會以及期刊發表。一直以來，我們實驗室最常使用的應用程式就是SigmaPlot，不可否認這個程式有其厲害之處，但我認為R語言可以包辦從資料處理、分析到繪圖，是相當全面的，而且程式語言的重複使用性讓我們不用每次繪圖都重新開一個檔案畫一次，也是一項優勢。  
我無意比較哪種軟體最好，只有最適合自己的方法，今天就來介紹如何使用R語言來繪製一個精美且可以進行期刊投稿的科學繪圖！  
  
*謂學不暇給者，雖暇亦不能學  
&mdash;《淮南子·說山訓》*
  
## 示範資料：iris  
熟悉R語言的人一定都聽過這個資料集，但是由於標榜從零開始，我必須先介紹一下`iris`，也就是鳶尾花資料集。這是一個多變數資料集，內容包含著有關鳶尾花的不同變數，而且已經內建在每個R語言下載包內，是相當適合用於教學的資料，稍微查了一下這個資料集還跟統計學之父R.A.Fisher有關呢。  
使用這個資料集的方法就是呼叫他：  
```
data(iris)  # 呼叫iris資料集  
head(iris)  # 展示這個資料的前六個row  
```
執行上述程式碼後將可以獲得以下的內容  
```
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
```
這就是`iris`資料集內包含的五個變數，而整個`iris`資料集共有150筆樣本。`Sepal.Length`、`Sepal.Width`、`Petal.Length`及`Petal.Width`是連續變數，而`Species`則是類別變數，要取出一個資料集中的某個變數，需要使用`$`，例如我想要Sepal.Length這個變數資料，就輸入`iris$Sepal.Length`即可。接下來，我就利用這個資料集來示範繪製可用於期刊發表的圖。  
  
## 最基礎的plot函數  
在R語言中，`plot`函數是個最為基本，操作起來直觀的函數，雖然陽春，但可以細微調整的地方也相當多，可以用來簡單觀察資料型態，也可以進行期刊投稿，基本上可以應付大多數的目的。  
對於繪製散布圖而言，`plot`函數的組成是這樣的 (我只列出常會用到的參數)：  
```
plot(x, y = NULL,              # xy座標，必須輸入對應的數值 (註1)
     type = "p",               # 指定線的種類 (註2)
     xlim = NULL, ylim = NULL, # 指定畫出來的範圍
     log = "",                 # 輸入"x"代表x軸取對數，"y"跟"xy"同理
     main = NULL, sub = NULL,  # 標題名
     xlab = NULL, ylab = NULL, # 座標軸名，分x跟y
     ann = par("ann"),         # 要不要顯示座標軸名稱，邏輯值 (註3)
     axes = TRUE,              # 要不要顯示座標軸，邏輯值
     frame.plot = axes,        # 圖要不要有外框，邏輯值
     asp = NA                  # x/y座標的長度比例 (註4)
     ...)
```
註1：上面這個是函數的預設組成，而裡面包含許多的參數例如`x`, `y`, `type`, `xlim`等等，如果某個參數幫你附註了`= XXX`，例如`y = NULL`，代表這個參數有預設值，你若不指定這個參數就會自動代入，相反的如果沒有預設值，就代表你必須給予x一個數值，否則函數將出現error。  
註2："p"代表點，"l"代表線，"b"代表有線串聯的點， "c"代表沒有點的的虛線，"o"代表線會畫在點上面，"s"和"S"代表階梯圖，"h"代表直線狀的長條圖，"n"則會是空的沒有圖。  
註3：邏輯值代表這個值需要輸入`True`或`False`，在`plot`函數中如果不做任何事就會是`T`而顯示該項目，如果不想顯示該項目則可以用`F`來關掉。  
註4：最常見就是asp = 1代表xy座標比例要一樣。  
  
首先，我們先隨意繪製一張圖：  

  
